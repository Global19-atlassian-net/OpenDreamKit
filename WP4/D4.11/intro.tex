%In this report we present a prototypical integration of the Jupyter notebooks into the MathHub.info portal for active mathematical documents and a versioned hosting system for flexiformal mathematics.
Jupyter notebooks offer a uniform interface to computation systems, including the ones involved in the OpenDreamKit project.
It is intended to serve as the frontend component of the virtual research environment (VRE) built by OpenDreamKit.
MathHub.info offers a scalable versioned project management system for formal content.
It is intended to serve as the backend component of the OpenDreamKit VRE.
MMT provides a formal system for representing the mathematical knowledge involved in the OpenDreamKit project.
It is intended to serve as the semantic integration layer of the OpenDreamKit VRE.
In this report, we describe the integration of the three components.

A Virtual Research Environment (VRE) for mathematics needs both kinds of interface functionality: mathematical documents have been very successful for presenting mathematical knowledge, and while there have been efforts to make them modular and interactive, remain the dominant mode of archiving and transporting knowledge in Mathematics.
Notebook interfaces which also use the document metaphor at the surface but concentrate on the REPL interaction and are largely a sequence of computational interaction cells where mathematical discourse largely appears in the form of ``extended comments''.
A ``literate programming'' version of notebooks which gives mathematical discourse structural precedence is possible in principle, but has not been supported consistently at the system level.
This tension and trade-off has been explored in OpenDreamKit Deliverable D4.9~\cite{ODK-D4.2}, and the concept of in-document computation in OpenDreamKit Deliverable D4.9~\cite{ODK-D4.9}.
In both cases, the integration was incomplete, since it lacked a full integration of the back-ends. 

Generally, the integration of MathHub and Jupyter consists of two parts: the integration of
\begin{inparaenum}[\em a\rm )]
\item user interfaces (as reported previously) and
\item the knowledge/computation management facilities. 
\end{inparaenum}
Here we report on progress in both: we for the backend integration we present an MMT kernel for Jupyter (knowledge management and Math-in-the-Middle-based distributed computation (see OpenDreamKit Deliverable D6.5~\cite{ODK-D6.5})).
We also show how the new Jupyter widgets can be deeply integrated with the MMT knowledge management facilities to give semantics-aware interaction facilities, extending the front-end capabilities of MathHub/Jupyter Notebooks by semantic widgets driven by the MMT in-document knowledge management services.
 
We show and evaluate the integration on two case studies: in-document computing facilities in active documents and a knowledge-based specification dialog for modeling and simulation. 

The goal of this report is to integrate Jupyter notebooks into MathHub
and make them compatible with MMT, in a way that we can conveniently use 
MMT syntax in these notebooks and also a little bit of extra functionality
like e.g. the Jupyter widgets. The first step is setting up a Jupyter server,
which currently runs on \url{http://juypter.mathhub.info}. \ednote{KA: maybe show picture of it?}
For this server, we have developed a custom kernel, that forwards the input 
entered into the Jupyter notebook to the MMT backend. This then processes 
said input and sends the response back to the Jupyter frontend via the kernel.
We will cover the implementation of the Jupyter kernel and the MMT-backend,
later in this report.


\paragraph{Overview}
Section~\ref{sec:mmt-jp} describes our MMT kernel for Jupyter.
Section~\ref{sec:nb-mh} presents the integration of Jupyter Notebooks in the MathHub front-end.
Section~\ref{sec:mitm-nb} presents two example applications.
Section~\ref{sec:concl} concludes the report and discusses future work.

\paragraph{Acknowledgements}
The authors gratefully acknowledge the support of the Jupyter team and in particular the advice of Benjamin Ragan-Kelly.
Theresa Pollinger worked on the MoSIS system~\cite{PolKohKoe:kacse18}, which has shaped our perception of the integration reported here, and which we sketch at the end. 

%%% Local Variables:
%%% mode: latex
%%% mode: visual-line
%%% fill-column: 5000
%%% TeX-master: "report"
%%% End:
