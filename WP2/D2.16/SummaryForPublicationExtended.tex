\section{Summary for Publication (extended)}

\subsection{Summary of the context and overall objectives of the project (including the conclusions of the action)}

Automating calculations has always been at the heart of mathematics, for exploring and discovering new mathematics, even proving theorems. Beyond mathematics it has been and will play ever increasing role in scientific progress.

Thus, since the advent of first machines, computing was adopted as a tool of choice by mathematicians. It has become their microscope, and is used nowadays at all stages of their research.

Building that microscope takes dedicated and expert efforts! In the last decades, vibrant communities of mathematicians have spearheaded the Open Science movement, developing a wide ecosystem of open tools covering all aspects of mechanized mathematics: computation, tabulation (data), deduction, and narration. Today there are a hundreds of these, often highly optimized for specific domains such as solving differential equations, generating combinatorial objects like graphs or error-correcting codes, or classifying elliptic curves, objects with important implications on both Fermat's Last Theorem and cryptography.
 
The ecosystem suffered, however, from fragmentation and from lack of recognition, as funding and career paths reward novel results rather than the daily work of fixing bugs and supporting users; this led to long standing technical issues which impeded its sustainability in a rapidly evolving landscape of computing. 

Meanwhile early Virtual Research Environments (VRE) had proven their potential to better serve the growing needs of mathematicians, reduce entry barriers, broaden the audience, and promote collaboration and Open Science.

Hence, when the EU H2020 Research E-Infrastructure Programme made a call for  proposals centered on Virtual Research Environments, a few pioneers initiated an open process to bring the communities together and craft collectively a proposal.

The ecosystem offered the potential to cover a large area of pure mathematics, and a variety of use cases ranging from one-system-one-laptop to multi-system institution-wide cloud deployments. This could not however be covered by a single one-size-fits-all VRE.

Therefore, the aim was set to *deliver a flexible toolkit enabling research groups to set up Virtual Research Environments, customised to meet the varied needs of collaborative research projects in pure mathematics and applications, and supporting the full research life-cycle from exploration, through proof and publication, to archival and sharing of data and code*

To make this ambitious aim possible, the existing communities joined forces to build upon and contribute back to their tools -- in particular popular ones such as LinBox, MPIR, SageMath, GAP, PARI/GP, LMFDB, Singular, MathHub. They further joined forces with the general purpose interactive computing environment Jupyter; in addition to outsourcing the user interface and VRE specific aspects, this maximised the impact on the scientific community at large.

This was the birth of OpenDreamKit (\#676541), a 7.6M\euro project that, from 2015 to 2019, gathered 50 scientists spread over seven European countries: France, Belgium, Norway, Germany, Poland, Switzerland, and United Kingdom. Coordinated by the Laboratoire de Recherche en Informatique (Universit√© Paris Sud and CNRS), OpenDreamKit employed an average of 11 full-time researchers and Research Software Engineers.

\subsection{Work performed from the beginning of the project to the end of the period covered by the report and main results achieved so far (including an overview of the results and their usage and dissemination)}

Over the duration of the project, work was performed on many fronts, in close collaboration with the community. 

One of the major hindrances for both end users and developers was limited availability and interoperability of various components of OpenDreamKit in different environments: oftentimes, software would work in the developers' environment (mostly Unix systems on Intel architectures), but fail in other environments (notably, Windows systems).

By integrating or updating best practices (continuous integration, continuous testing, ...), embracing emerging technologies (Docker containers, Conda packages, ...), by decoupling components and sharing infrastructure, we managed to make OpenDreamKit components available and interoperable in a much wider range of environments.  Notable success stories are:

\begin{itemize}
\item Porting of the components to Windows, MacOS and Linux;
\item Distribution of the components through official package repositories for major Linux distributions (Debian, Ubunut, Fedora, Arch, Gentoo);
\item Distribution of Docker images and Conda packages suited for deployment of our components in cloud environments (in particular, with JupyterHub and Binder integration);
\item Porting of SageMath to Python 3.
\item Modularization of various OpenDreamKit components, in particular SageMath and GAP.
\end{itemize}

To address the increasing need in high performance computing in computational mathematics, we drove the leading software components into supporting a large range of parallel architectures, from the low level SIMD, to GPUs, multi-core or clusters. Thanks to the introduction of new algorithms, tuned implementations and the design of parallel engines allowing to smoothly transition between various parallel settings, we made users able to harness the power of most modern computing platforms ranging from personal laptops to HPC clusters.

We contributed to a tight integration of OpenDreamKit components with Jupyter and to the Jupyter ecosystem itself, notably through new tools for collaboration (nbdime), validation (nbval), interactive web pages (thebelab), 3D visualisation (K3D-jupyter), interactive mathematics (sage-combinat-widgets, francy, ...), and through contributions to existing tools for collaborative workspace management (JupyterHub, JupyterLab). We also were early adopters, deployers and promoters of emerging technologies like Binder.

To demonstrate the applicability of our technology well beyond mathematics, we integrated micromagnetism computational engines into Jupyter to deliver a Virtual Research Environment taylored for interactive micromagnetism calculations.

We also authored four interactive textbooks, delivered numerous courses or actively helped colleagues doing so, in a variety of fields ranging from biology to computer science, all using Jupyter technology.

Finally we explored novel knowledge-based approaches for the high-level integration of large stacks of mathematical components. Like an interpreter for human language, it ensures meaning-preserving communication in mathematical languages between computation systems, databases, and humans. Concrete outcomes for bridging the gap between computation and data are already in production: data generation (py-persist/Memoize), online data exploration (data.mathhub.info) and live data exploration (sage-explorer).

All the outcome of the project were open and distributed widely through the usual channels to their target communities, reaching TRL 6 to 8. In addition, community building, training, and dissemination activities have been at the forefront of OpenDreamKit, with more than one hundred events organized or co-organized by OpenDreamKit, including developer workshops, training conferences, or satellite sessions, adding up to 1800 trainees. We also actively promoted diversity, through dedicated actions aimed at women and residents of developing countries. In particular, we organized two Women In Sage workshops and participated in or co-organized events in Colombia, Mexico, Nigeria, Algeria, Morocco, Tunisia, Palestine and Lebanon. We also created resources for researchers and teachers to accompany them in their use of the technologies we promote, such as tutorials, explainer comics and short videos. This includes contributions to the open textbook Computational Mathematics with SageMath which is nowadays reaching 500 downloads per day.

\subsection{Progress beyond the state of the art, expected results until the end of the project and potential impacts (including the socio-economic impact and the wider societal implications of the project)}

On the user-visible front, researchers, teachers and scientists in general now benefit from a rich uniform web-based user interface to all the OpenDreamKit computational components (from SageMath to C++!), which they can use on a wide variety of platforms, including tablet PCs, laptops, computer labs, all the way to cloud deployment and services, non-commercial (University-wide, EGI, Binder, ...) or commercial (Cocalc, Azure, OVH, Google, ...). We contributed to the deployment of a number of such installations for Mathematics, Computer Science, or Micromagnetism, demonstrating the versatility of the toolkit.

We have ourselves used extensively all the elements of the OpenDreamKit toolkit, while pursuing our own research, and while delivering many courses and training sessions in a wide variety of contexts --- from universities all over Europe, all the way to Nigeria or the AIMS institute in South Africa, creating interactive teaching material, sharing research results with the community, developing mathematical experiments, and much more.
This was the occasion to reflect on the adequacy and adoption of the tools for end-users, and immediately feedback the outcome into the project development.

By enabling Research Software Engineers to focus full time for months in a row on delicate challenges, we have tackled problems that the communities had been facing for a decade, such as bringing to fruition the effort to make GAP multi-threaded (HPC-GAP project) or porting SageMath and its dependencies to the Windows platform.
This has demonstrated the enormous value that Research Software Engineers (RSE) can bring to research, to support of end-users and collaborative developments by the community, and, generally speaking, Open Science. We have played an important role in the RSE movement, notably in the UK, exploring numerous hot and difficult questions: role, funding patterns, structuring, career paths, etc.

As was hoped, OpenDreamKit delivered a boost to the landscape of open source math software; it strives ever more than five years ago. We are particularly proud to have brought together many computational mathematics communities that, at earlier times, had been evolving independently, if not outright in a mostly counter-productive competition. Despite the occasional and unavoidable frictions occuring whenever needs and goals do not align, seeking collaboration has become the norm. 

\textbf{Nevertheless, the major challenge to come is to secure employment of a number of Research Software Engineers, as much as possible in long term positions, to support hundreds of contributors and tens if not hundreds of thousands of users of open source math software.}


As witnessed by the ACM award and by the wide adoption of the Jupyter technology in research, education (even at high school level), and industry, the Jupyter ecosystem has been booming during the course of OpenDreamKit; it is there to remain a major player of the field for years to come.  OpenDreamKit played a significant accelerator role by providing core Jupyter development.

Of particular relevance is its adoption by a number of EU-funded projects working towards the European Open Science Cloud (EOSC) -- in particular for remote access, remote analysis and visualisation of data, and for improved reproducibility. These projects directly benefit from outcomes of OpenDreamKit; they however position themselves as users of the Jupyter technology, not developers.

\textbf{It is therefore crucial that the EU keeps funding core Jupyter development, as an asset for the EOSC, science and industry, as well as to enable the continuing acceleration, and steering in the right direction, of this key open technology.}

Finally, beyond the traditional items of Open Science, namely Open Source, Open Data, and Open Publications, we have explored a novel item, namely Open EU Project Management, and demonstrated its effectiveness. Indeed, we strongly believe that preparing the proposal and running the project completely in the open with a bottom up approach has played a fundamental role in engaging the communities, developing reciprocal trust, locating the toughest hurdles that users and developers actually face, co-designing solutions and co-implementing them efficiently. 

\textbf{We strongly recommend the experience; long live OpenDreamKit's spirit!}
