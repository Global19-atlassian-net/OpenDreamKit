\subsubsection{WorkPackage 3:  Component Architecture}
%Explain, task per task, the work carried out in WP during the reporting period giving details of the work carried out by each beneficiary involved.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Overview}

This Work Package focuses on the structure of the components that make
up a mathematical software and their interactions. Such components can
be separate modules inside a unique software, or separate software
interacting through library calls and/or through APIs.
%
The last reporting period has focused mainly on integration and
packaging, producing, maintaining and consolidating official packages
for Linux distributions and Conda.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subparagraph{Milestones} Helping end users perform computations on
whatever hardware they possess is one of the major goals of
OpenDreamKit, and of WP3 in particular. The only milestone involving
WP3 is

\subparagraph{\longmilestoneref{component-architecture-distribution}}

\emph{“User story: users shall be able to easily install ODK's
    computational components on the three major platforms (Windows,
    Mac, Linux) via their standard distribution channels.”}

  The completion of
  \longdelivref{component-architecture}{sage-distribution} completes
  the work done in the previous reporting periods by making all
  OpenDreamKit components available in the major Linux distributions
  (Debian, Ubuntu, Fedora, ...) through their official
  channels\footnote{Note that the role of OpenDreamKit is to
    facilitate packaging for Linux distributions, by simplifying
    dependency management and build chains, and keeping up to date
    with dependencies. It is not OpenDreamKit's goal to directly take
    the lead on packaging for the dozens of available distributions,
    as this would not be sustainable.}.

  Windows and MacOS binaries have also been regularly distributed
  since at least two years. The milestone has thus been successfully
  achieved, and we consider the overall work done in this work package
  a success.
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Tasks}

  \subparagraph{\longtaskref{component-architecture}{portability}}
  \label{component-architecture@portability}
  The first task of this workpackage is to improve the portability of
  computational components.

  The fundamental milestone in this task was achieved during the
  second reporting period, with the release of \Sage 8.0 in July 2017,
  the first release with native support for Windows. At the start of
  the current reporting period all \ODK components were thus available
  for all three major platforms (Windows, Mac, Linux), through several
  channels: executable installers, official packages, Conda packages
  and Docker images.

  The work in this reporting period has thus essentially consisted in
  maintaining and consolidating the available software.

  \subparagraph{\longtaskref{component-architecture}{interface-systems}}
  \label{component-architecture@interface-systems}
  In this task we investigate patterns to share data, ontologies, and
  semantics across computational systems, possibly connected remotely.
  
  The work concerning this work package was essentially completed in
  Year 1. During this reporting period, a refactoring of the
  \GAP--\Sage interface, in the form of an official C API named
  \libGAP, has taken place. For conciseness, this achievement has been
  reported in a different work package: \localtaskref{hpc}{hpc-gap}.
  
  \subparagraph{\longtaskref{component-architecture}{mod-packaging}}
  \label{component-architecture@mod-packaging}
  In this task we investigate best practices for composing, sharing
  and interfacing computational components and data for connected
  mathematical systems.

  Thanks to the joint efforts of OpenDreamKit and of the community,
  \Sage has been available as a Debian/Ubuntu package since June 2017,
  as an experimental Conda package since the summer of 2017, and as a
  package for several other Linux distributions (Fedora, Arch, Gentoo,
  \dots) for even longer. The work in this reporting period has
  consisted in consolidating and helping update these packages, as
  reported in detail in deliverable
  \delivref{component-architecture}{sage-distribution}.

  More maintenance work has gone into keeping the Windows and MacOS
  versions up to date. In particular, since version 8.2 \Sage is
  compatible with the C compiler clang, ensuring long-term
  sustainability for the MacOS port.

  An effort has been put into unvendoring system/external libraries and tools historically
  packaged in \Sage, towards the goal of making \Sage installable via
  the standard Python tools such as pip. In the reporting period a general
  unvendoring structure has been designed and implemented, and over 40
  non-Python components of \Sage (about 50\% of such components)
  received configuration scripts allowing the use of the corresponding
  system libraries or tools. Most of this work has been done by OpenDreamKit
  members.


  One of the main roadblocks for this task is porting \Sage to Python
  3, indeed as Python 2 is coming to its end of life in 2020,
  finalizing the port is crucial for the future of \Sage. Fortunately
  this task was essentially completed during the last reporting
  period: the current stable version, \Sage 8.8, is already compatible
  with Python 3, and \Sage 9.0, expected at the beginning of 2020,
  will be the first \Sage version to be officially based on Python 3.

  \subparagraph{\longtaskref{component-architecture}{simulagora-dev}}
  \label{component-architecture@simulagora-dev}
  The goal of this task was to deliver Simulagora VM images that can be
  used by the end-users to run computations with the tools enhanced or
  developed in the project.
  
  In the Simulagora platform, we have integrated Jupyter as a key product
  that can be used by scientists (expert users) to develop dedicated tools
  with very little development skills : a notebook (containing fields) is
  used to collect and pre-process the data, this data is used by a script
  that runs computation codes, and finally a notebook containing the results
  and their visualization is produced. The scientist only has to write two
  notebooks and one script in order to produce a customized scientific tool
  that runs in the cloud and that can be used by several end-users (regular
  users).
  
  During the project, the improvment in the Jupyter ecosystem and the emergence
  of the binder tool decrease the usefulness of a platform such as Simulagora.
  Today, its main benefit is the ability to easily build a Web tool around a
  legacy heavy computation code (that might be difficult to install with
  the binder process), or to run parametric studies that need thousands
  computations.
  
  \subparagraph{\longtaskref{component-architecture}{component-for-HPC}}
  \label{component-architecture@component-for-HPC}
  The goal of this task is to investigate and implement
  parallelism-friendly ways of combining components together, so that
  calling components can benefit from the parallelism features of
  called components.

  We used \Sage and its components as a test-bed, by producing an
  HPC-enabled distribution of \Sage. This distribution is able to
  exploit parallel features in \Linbox, \GAP, \Singular and \PariGP,
  and some of those have been integrated in the official \Sage
  distribution. Nevertheless, several roadblocks still exist,
  preventing these components from cooperating seamlessly in a
  parallel environment. The work accomplished and the limitations have
  been reported in deliverable  
  \delivref{component-architecture}{hpc-configure}.

  This task was the occasion for a tightly knit collaboration between
  all \ODK participants involved in High Performance Mathematical
  Computing, leading to rich exchanges of expertise and best practice,
  and the building of a shared vision.
  
  \subparagraph{\longtaskref{component-architecture}{extract-smc}}
  \label{component-architecture@extract-smc}
  Not applicable for this period.
  
  \subparagraph{\longtaskref{component-architecture}{workflow}}
  \label{component-architecture@workflow}
  Not applicable for this period.
  
  \subparagraph{\longtaskref{component-architecture}{oommf-python-interface}}
  \label{component-architecture@oommf-python-interface}
  Not applicable for this period.

  
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "report"
%%% End:

%  LocalWords:  subsubsection longmilestoneref emph longdelivref portability-cygwin
%  LocalWords:  prioritizing longtaskref multiplatform-buildbot Composability delivref
%  LocalWords:  simulagora-dev Simulagora extract-smc cocalc personal-smc smc-trac
%  LocalWords:  oommf-python-interface
