\subsection{Explanation of work carried out per Objective}
%List the specific  objectives  for  the  project  as  described  in  section  1.1  of  Part B   and describe  the  work  carried  out  during  the  reporting  period  towards  the  achievement  of  each listed objective. Provide clear and measurable details.
For reference, let us recall the aims of \ODK.
\begin{compactenum}[\bf {Aim} 1\rm]
\item \label{aim:collaboration} Improve the productivity of
  researchers in pure mathematics and applications by promoting
  collaborations based on mathematical \textbf{software},
  \textbf{data}, and \textbf{knowledge}.
\item \label{aim:vre} Make it easy for teams of researchers of any
  size to set up custom, collaborative \emph{Virtual Research
    Environments} tailored to their specific needs, resources and
  workflows. The \VREs should support the entire life-cycle of
  computational work in mathematical research, from initial
  exploration to publication, teaching and outreach.
  % and bridge the gaps between
  % code, published results, and educational material.
\item \label{aim:sharing} Identify and promote best practices in
  computational mathematical research including: making results easily
  reproducible; producing reusable and easily accessible
  software; sharing data in a semantically sound way; exploiting and
  supporting the growing ecosystem of computational tools.
\item \label{aim:impact} Maximise sustainability and impact in
  mathematics, neighbouring fields, and scientific computing.
\end{compactenum}

Those aims are backed up in our proposal by nine objectives; we now
highlight our main contributions during this reporting period toward
achieving each of them.

\begin{compactenum}[\bf {Obj} 1\rm]
\item\label{objective:framework} \textbf{Virtual Research Environment Kit:} ``\emph{To develop and standardise an architecture
    allowing combination of mathematical, data and software components with off-the-shelf
    computing infrastructure to produce specialised \VREs for different communities.}''

  By building around the \Jupyter ecosystem,
  all \ODK components can be assembled in different combinations
  to make a VRE suitable for a variety of communities,
  especially in mathematics and education.
  This has been highly successful,
  enabling VREs in fields from mathematics
  to micromagnetics,
  all using common \ODK components,
  which can be mixed and matched to serve
  the target community.

  This objective is by nature multilevel; achievements include:
  \begin{itemize}
  \item Collaborative workspaces: major JupyterHub and JupyterLab developments,
  for collaboration,
  both real-time and via version control systems such as git,
    see~\longlocaltaskref{UI}{notebook-collab};
  \item User interface level: enabling \Jupyter as uniform interface for all computational
    components; see \longlocaltaskref{UI}{ipython-kernels}.
  \item Interfaces between computational or database components:
    \begin{itemize}
    \item \emph{short term}: refactoring of existing ad-hoc interfaces, see \longlocaltaskref{UI}{pari-python};
    \item \emph{long term}: investigation of patterns to share data, ontologies, and semantics uniformly across components, see \longlocaltaskref{component-architecture}{interface-systems}, and Section~\ref{dksbases} about \WPref{dksbases}, where we report on the ``Math-in-the-Middle'' (MitM) paradigm for semantic system integration and non-trivial mathematical use cases. In RP3, we have added interoperability of mathematical data sets to the mix.
  \end{itemize}
\end{itemize}

\item\label{objectives:core} \textbf{Core Components:}
  ``\emph{To develop open source core components
  for \VREs where existing software is not suitable. These components
  will support a variety of platforms, including standard cloud
  computing and clusters. This primarily addresses Aim~\ref{aim:vre},
  thereby contributing to Aim \ref{aim:collaboration}
  and~\ref{aim:sharing}.}''

  At this stage, it has been possible to implement most of the required developments within
  existing components or extensions thereof. For the
  Math-in-the-Middle paradigm for semantic system interoperability we have developed
  knowledge-based Mediator based on the MMT system.
  In RP3 we have concentrated on mathematical data sets. We have added a data aspect to \textsf{MathHub.info} which allows dataset authors to semantically  describe data sets and then generate database schemata, management functionality, and user interfaces from that.

  Real-time collaboration has been developed as a feature in JupyterLab,
  as part of \longlocaltaskref{UI}{jupyter-live-collab},
  and \longlocaltaskref{UI}{jupyter-collab} has delivered nbdime,
  an important tool for collaboration on \Jupyter notebooks.

  These core components can be deployed as part of a VRE.
  The task of assembling a VRE from these components
  has been greatly facilitated by work in \longlocaltaskref{component-architecture}{mod-packaging},
  including packaging of numerous \ODK components
  in the conda packaging system.


\item \label{objective:community}
  \textbf{Community Building across Disciplines:}
  ``\emph{To bring together research
    communities (e.g. users of \Jupyter, \Sage, \Singular, and \GAP) to
    symbiotically exploit overlaps in tool creation building efforts,
    avoid duplication of effort in different disciplines, and share best
    practice. This supports Aims~\ref{aim:collaboration},
    \ref{aim:sharing} and~\ref{aim:impact}.}''

  We have organized or co-organized a dozen users or developers
  workshops (see~\longlocaltaskref{dissem}{devel-workshops}) which brought
  together several communities. Some key outcomes include:
  \begin{itemize}
  \item Enabling \Jupyter as uniform interface for all computational components; see \longlocaltaskref{UI}{ipython-kernels}.
  \item Sharing best practices for development, packaging, building containers (see~\longlocaltaskref{component-architecture}{mod-packaging}), and continuous integration (see~\longlocaltaskref{component-architecture}{portability});
  \item A smooth collaboration between \JupyterHub, and \Simulagora; see~\longlocaltaskref{component-architecture}{simulagora-dev} and Section~\ref{infrastructures};
  \item Work on interfaces between systems; see \longlocaltaskref{component-architecture}{interface-systems}, \longlocaltaskref{UI}{mathhub}, and \longlocaltaskref{UI}{pari-python};
    % \item Steps toward \longlocaltaskref{UI}{sage-sphinx}
  \item Sharing of best practices and tools for authoring live structured documents (see~\longlocaltaskref{UI}{structdocs});
  \item Developing interactive documentation
  \item Sharing of best practices when using VRE's like \cocalc or \Jupyter for research and education;
  \item Sharing of best practices in developing modularized parallel linear algebra kernels and there integration into \SageMath (see \longlocaltaskref{component-architecture}{component-for-HPC})
  \item Collaboration on interactive visualization \longlocaltaskref{UI}{vis3d}, \longlocaltaskref{UI}{cfd-vis}, \longlocaltaskref{UI}{dynamic-inspect}.
  \item Jump-starting a community on semantically described, interoperable mathematical data sets around \url{data.mathhub.info}. A Math Data workshop (8 Days) in Cernay included external mathematicians and will be continued by external partners in 2020;
  \item Packaging of \ODK components in the conda-forge ecosystem
  for easier and wider dissemination and use by a large community;
  \item Integration of \ODK participants into the core JupyterLab team,
  to ensure development of JupyterLab to serve \ODK needs,
  in particular live collaboration features \longlocaltaskref{UI}{jupyter-live-collab};
  \item Adoption of modern software engineering practices throughout \ODK components,
  such as Continuous Integration,
  leveraging cross-domain expertise
  in mathematics and software engineering,
  see \longdelivref{dksbases}{persistent-memoization}.
  \end{itemize}

\item \label{objective:updates}
  \textbf{Updates to Mathematical Software Components:}
  ``\emph{Update a range of existing open source
  mathematical software systems for seamless deployment and efficient
  execution within the VRE architecture of objective~\ref{objective:framework}.
  This fulfils part of Aim~\ref{aim:vre}.}''

  Achievements include:
  \begin{itemize}
  \item Continuous efforts of development, release and integration within \SageMath
    have been put for
    \begin{itemize}
    \item  the linear algebra computational kernels of \Linbox,
      \fflasffpack and \textsc{Givaro} (Deliverables~\longdelivref{hpc}{LinBox-algo} and~\longdelivref{hpc}{LinBox-distributed}),
    \item the PARI library for computational number theory
      (Deliverable~\longdelivref{hpc}{pari-hpc2} still ongoing),
    \item the GAP software for computational group theory
      (Deliverable~\longdelivref{hpc}{GAP-HPC-report}),
    \item the FLINT and Singular software for commutative algebra
      (Deliverable~\longdelivref{hpc}{singular-polyarith}).
    \end{itemize}
  \item Packaging efforts: docker containers (delivered and regularly
    updated), Debian and Conda packages; see
    \longlocaltaskref{component-architecture}{mod-packaging}, in
    particular~\delivref{component-architecture}{sage-distribution}.
  \item Continued efforts on portability of \SageMath and its dependencies
    (see \longlocaltaskref{component-architecture}{portability}).
  \item Improved continuous integration and development workflow.
  \item Integration of all the relevant mathematical software in the
    uniform \Jupyter user interface, in particular for integration in
    the VRE framework (delivered, ongoing); see
    \longlocaltaskref{UI}{ipython-kernels}.
  \item Work in \WPref{hpc} and \WPref{component-architecture} to better support HPC in the
    individual mathematical software system and combinations thereof;
    see Section~\ref{hpc} and~\delivref{component-architecture}{hpc-configure}.
  \item The \SageMath and \GAP systems have been extended by a persistent memoization package, which allows to cache computational results and even share them between any system that implementes the memoization format; see \longdelivref{dksbases}{persistent-memoization} for details.
  \item Ongoing work on the MMT system which forms the basis of the \WPref{dksbases}: Work on \taskref{dksbases}{isabelle} has led to a tight integration with the Isabelle theorem prover and a complete revamp of the code for indexing theory morphisms (crucial for the MitM-based integration of VRE components).
  \end{itemize}

\item \label{objective:sustainable}
  \textbf{A Sustainable Ecosystem of Software Components:}
  ``\emph{Ensure that our ecosystem of
  interoperable open source components is \emph{sustainable} by
  promoting collaborative software development and outsourcing
  development to larger communities whenever suitable. This fulfils
  part of Aims~\ref{aim:sharing} and~\ref{aim:impact}.}''

  Achievements include:
  \begin{itemize}
  \item Continued work on outsourcing the computational system user interfaces by migrating to \Jupyter, eventually deprecating outdated interfaces such as the \Sage notebook; see \longlocaltaskref{UI}{ipython-kernels};
  \item Refactoring \Sage's documentation build system to contribute many local developments
    upstream (\Sphinx) \longlocaltaskref{UI}{sage-sphinx};
  \item Outsourcing and contributing upstream as \Python bindings the existing \Sage
    bindings for many computational systems; see \longlocaltaskref{UI}{pari-python}.
  \item Migrating \Sage to Python 3, see \longlocaltaskref{component-architecture}{mod-packaging}.
  \end{itemize}

\begingroup
\color{gray}
\item \label{objective:social}
  \textbf{Engineering Social Interactions in Open Source \VRE:}

  This objective was the social science research side of
  \WPref{social-aspects}. Following the work plan revisions after
  Reporting Period 1, the manpower originally allocated to this
  objective was reallocated to other objectives. There thus was no new
  achievements in Reporting Period 2 and 3.

\endgroup

\item \label{objective:data}
  \textbf{Next Generation Mathematical Databases:}
  ``\emph{Identify and extend ontologies and
  standards to facilitate safe and efficient storage, reuse,
  interoperation and sharing of rich mathematical data whilst taking
  account of provenance and citability. This fulfills parts of
  Aims~\ref{aim:vre} and~\ref{aim:sharing}.}''

  This objective is at the core of \WPref{dksbases}; see Section~\ref{dksbases} for details.
  In the first two reporting periods \WPref{dksbases} has developed the Math-in-the-Middle ontology that acts as the pivot point mediating between system languages in the MitM interoperability framework.
  This work has been reported in deliverables \delivref{dksbases}{psfoundation} and \delivref{dksbases}{lfmverif}.

  In the third reporting period the focus of \WPref{dksbases} has been on instantiating the FAIR principles for mathematics (we call the result \textbf{deep FAIR}) and turning mathematical datasets into deep FAIR VRE components.
  This work has been reported in \delivref{dksbases}{nbad-search}.
  The \dmh system, which implements deep FAIR datasets from scratch meets exactly the objectives stated above -- but the system is still very young and needs to attract a critical mass of datasets and community.
  The LMFDB system which has both has been retrofitted with aspects of deep FAIR in \pn, and is much more interoperable than at the start of \pn.
  In parallel, and somewhat dual (lightweight/ad-hoc persistent data caching for mathematical software systems), is the work on \tasktref{dksbases}{data-memo}. Here we have developed a  data memorization format and corresponding memoization packages for \Python (for \Sage) and \GAP.
  These have the potential to lead (by collecting computation results on the side) to informal data sets, which can be semantified later.

\item \label{objective:demo}
  \textbf{Collaborative Research Environments that Transcend Domains:}
  ``\emph{Demonstrate the effectiveness of Virtual
    Research Environments built on top of \ODK components for a
    number of real-world use cases that traverse domains. This addresses
    part of Aim~\ref{aim:vre} and through documenting best practices in
    reproducible demonstrator documents Aim~\ref{aim:sharing}.}''

  The Ubermag (previously JOOMMF) project is a demonstrator for the
  versatility of the research environment infrastructure developed in
  this project.  Users of Ubermag can control simulation tools for
  devices based on nanomagnetism through the Jupyter notebook
  interface, document and share designs for new devices through static
  html and pdf versions of the notebook, and complement publications
  with executable notebooks hosted on myBinder. The required
  computations are of numerical nature (not symbolic), the simulation
  results are floating point numbers, and the users are engineers and
  material scientists from academia and industry -- this is very
  different from doing mathematical computation as pushed forward in
  most other activities in the project. Nevertheless, the tool sets we
  have developed and improved can be applied nearly independent of the application
  domain: the Jupyter Notebook, the tools nbval, nbdime, nbconvert,
  Binder and 3d rendering of output using k3d.

  Another use case of our virtual research environment infrastructure
  is that of interactive executable textbooks (see~\localtaskref{dissem}{ibook}).
  We have demonstrated
  that such novel and executable text books covering physics,
  mathematics and data science aspects can all be put together in this
  framework, and that they benefit from the infrastructure methodology
  improvements we have achieved. This applicability is independent of
  the application domain.

  A significant outcome of this project is to pave the way for
  other research projects (EC-funded or not) that make use of Jupyter
  and its growing ecosystem. While we have made significant progress,
  it is fair to say that there is substantial work left.
  By solving large challenges the Jupyter ecosystem,
  \ODK has made addressing new use cases feasible
  that were not possible when \ODK started.

  We note that a number of projects working towards the European Open
  Science Cloud (EOSC) have chosen the Jupyter Notebook and tools as a
  technology to realise the EOSC -- in particular for remote access,
  remote analysis and visualisation of data, and for improved
  reproducibility. These projects will directly build on and benefit
  from \ODK.  It is also clear that further features are
  requested by the community and that these will improve the EOSC
  projects and the EOSC itself.  There is currently no resource to
  provide this further development of the Jupyter ecosystem for EOSC in particular -- the funded projects understand themselves
  as users of Jupyter, not developers.


%Long term sustainability
\item \label{objective:disseminate}
  \textbf{Training and Dissemination:}
  ``\emph{Promote and disseminate
    \ODK to the scientific community by active communication,
    workshop organisation, and training in the spirit of open-source
    software. This addresses Aim~\ref{aim:impact}.}''

  \ednote{@Izabela: update number of meetings and workshops}
  This objective is at the core of \WPref{dissem}, with in particular
  29 organized events during the third reporting period: 7 development workshops, 10 training and community building
  workshops ( including one targeted at women and one in a developing country),1 research conference 
  and 11 communication and participation in external events. See
  Section~\ref{dissem} and \longdelivref{dissem}{workshops-4} for more
  details.
\end{compactenum}

%%% Local Variables:
%%% mode: latex
%%% mode: visual-line
%%% fill-column: 5000
%%% TeX-master: "report"
%%% End:

%  LocalWords:  compactenum textbf aim:vre emph JupyterHub longtaskref notebook-collab Simulagora mathhub visualization cfd-vis fflas-ffpack Givaro LinBox-algo multiplatform-buildbot nbad-search dmh psfoundation lfmverif
%  LocalWords:  extract-smc Jupyter localtaskref ipython-kernels dksbases WPref dksbases
%  LocalWords:  nbmerge nbdiff nbval delivref delivref jupyter-collab dissem organized
%  LocalWords:  cocalc portability-cygwin hpc taskref citability fulfills
%  LocalWords:  dissemination-of-oommf-nb-virtual-environment oommf-python-interface
%  LocalWords:  dissemination-of-oommf-nb-workshops
